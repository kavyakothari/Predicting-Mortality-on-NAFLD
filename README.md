
<h1>Predicting-Mortality-on-Non Alcoholic Fatty Liver Diseases</h1>

### Abstract

<p>By examining data sets from population research, this longitudinal study seeks to predict outcomes in people with non-alcoholic fatty liver disease (NAFLD). NAFLD patients and matched controls in the research were monitored for metabolic abnormalities, cardiac endpoints, and mortality. Using this substantial dataset, the project intends to create predictive models for metabolic abnormalities, cardiac events, and mortality in NAFLD. The results of this study will aid in improving the understanding of the long-term effects of NAFLD and in the creation of focused therapies to enhance patient outcomes.</p>

### About DataSet
<p>The dataset employed in this study, "nafld1,csv," is made up of a thorough compilation of data acquired from a population study on non-alcoholic fatty liver disease (NAFLD). It has 17,549 observations across 10 variables, providing crucial knowledge regarding the characteristics and prognoses of NAFLD patients. The dataset provides information on demographic, anthropometric, and clinical factors that are associated with metabolic disorders, cardiac endpoints, and mortality.</p>
<p>The dataset nafld1 is a CSV file with 17549 observations on the following 10 variables. They are as follows: - id: Each participant in the study is given a unique identification number called a subject identifier. Using this variable, participants can be tracked and distinguished throughout the investigation. age: The "age" variable in the dataset tells us how old each person was when they joined the study. height: The height variable records the height of each subject, measured in centimeters. It enables the calculation of body mass index (BMI) and helps evaluate the impact of height on NAFLD-related complications. bmi: The body mass index represents the calculated BMI of each subject, which is derived from their weight and height measurements. BMI serves as a valuable indicator of obesity and its association with NAFLD progression. case.id: The case identifier variable links each subject to the corresponding NAFLD case to which they are matched. This matching allows for comparative analyses between NAFLD cases and control subjects. ‘futime’: The ‘futime’ variable denotes the duration from the initial entry into the study until either the occurrence of death or the most recent follow-up. It provides crucial information about the length of the follow-up period for each subject. </p>
You can find dataset in the respository.

### Methodology

<div> <p>A total of 4 models were implemented which included:
Logistic Regression, Random Forest, XGBoosting, and Logistic Regression with Hyperparameter Tuning.
For this implementation first, the dataset was split into training and testing data. The split was 80-20% of
the entire data.
All the above models were implemented using Python’s ScikitLearn Library. </p>
<p>Logistic regression, which is a linear model, was trained using the logistic regression function and its predictions were made using the prediction method. Accuracy, precision, recall, and AUC-ROC scores were calculated to evaluate the model. For Random Forest, a random forest classifier was trained using the Random Forest Classifier function, and predictions were made on the test data. Accuracy, precision, recall, and AUC-ROC scores were calculated to evaluate the model's performance. Similarly, for XGBoosting, a custom class called XGBoosting was defined. The XGBoosting class had methods to fit the model, make predictions, and calculate mean absolute error (MAE), mean squared error (MSE), and R-squared score. The XGBoosting model was trained using the XGBRegressor function from the xgboost library. The predicted values were obtained using the predict method. Metrics such as precision, recall, AUC-ROC score, MAE, MSE, and R-squared score were printed to assess the performance of the XGBoosting model. Overall, logistic regression, random forest, and XGBoosting were implemented with their respective evaluation metrics to address the classification task in the project.
For Logistic Regression using Hyperparameter tuning, a hyperparameter grid was defined using the param_grid dictionary. The grid included hyperparameters for the logistic regression model, such as the inverse of regularization strength (C), regularization penalty type (penalty), and the algorithm for optimization (solver). The GridSearchCV function was used to perform a grid search with cross-validation, where the logistic regression model is trained and evaluated using different combinations of hyperparameters. </p>
<p>The grid search identifies the best hyperparameter values that yield the highest performance based on the provided evaluation metric (default is mean accuracy) across the specified number of cross-validation folds (cv=5).
The best hyperparameter values found using grid_search.best_params_ were - ‘C’: 0.1, 'penalty': 'l1', 'solver': 'liblinear'. The best logistic regression model, best_logreg, was obtained using grid_search.best_estimator_.Predictions were made using the best logistic regression model on the test data (X_test). The accuracy, precision, recall, and AUC-ROC score were calculated to evaluate the performance of the best logistic regression model. Precision and recall were computed using precision_score and recall_score functions, respectively. The predicted probabilities for the positive class were obtained using predict_proba and stored in y_scores. The AUC-ROC score was calculated using roc_auc_score.
The grid search approach helps in finding the optimal hyperparameter values, leading to improved model performance
</p>

##### Note: Refer to the 'Predicitng-Mortality-on-NAFLD.pdf' paper for more.
